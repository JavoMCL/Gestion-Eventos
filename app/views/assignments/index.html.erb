<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2>Asignaciones</h2>
    <%= link_to "Nueva Asignación", new_assignment_path, class: "btn btn-success" %>
  </div>

  <div class="mb-3 d-flex justify-content-end">
    <%= form_with url: assignments_path, method: :get, local: true, class: "d-flex" do %>
      <%= text_field_tag :search, params[:search], class: "form-control me-2", placeholder: "Buscar..." %>
      <%= submit_tag "Buscar", class: "btn btn-primary" %>
    <% end %>
  </div>

  <% if @assignments.any? %>
    <table class="table table-striped table-bordered">
      <thead class="table-light">
      <tr>
        <th>Evento</th>
        <th>Empleado</th>
        <th>Rol</th>
        <th>Tarea</th>
        <th>Estado</th>
        <th>Acciones</th>
      </tr>
      </thead>
      <tbody>
      <% @assignments.each do |assignment| %>
        <tr>
          <td><%= assignment.event.name %></td>
          <td><%= assignment.employee.name %></td>
          <td><%= assignment.role %></td>
          <td><%= assignment.task %></td>
          <td><%= assignment.state %></td>
          <td>
            <%= link_to "Editar", edit_assignment_path(assignment), class: "btn btn-warning btn-sm" %>
            <%= link_to "Eliminar", assignment_path(assignment),
                        data: { turbo_method: :delete, turbo_confirm: "¿Deseas eliminar esta asignacion?" },
                        class: "btn btn-danger btn-sm" %>
          </td>
        </tr>
      <% end %>
      </tbody>
    </table>
  <% else %>
    <p class="text-muted">No hay asignaciones registradas.</p>
  <% end %>

  <div class="mt-3">
    <div class="d-flex justify-content-between align-items-center">
      <small class="text-muted">
        Mostrando <%= @assignments.offset_value + 1 %> - <%= @assignments.offset_value + @assignments.length %>
        de <%= @assignments.total_count %> artículo<%= @assignments.total_count != 1 ? 's' : '' %>
        <% if params[:search].present? %>
          (resultados de búsqueda)
        <% end %>
      </small>
      <%= paginate @assignments, params: { search: params[:search] } %>
    </div>
  </div>
</div>

